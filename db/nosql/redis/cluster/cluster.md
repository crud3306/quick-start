
redis3.0以后，才有redis cluster集群。  
集群实际就是一个cluster，这个cluster要从两个方面考虑，一个是性能的叠加，另外一个就是可以实现高可用性。  
集群：有多个master，每个master至少有一个slave。比如该示例，3台master，3台slave  

可用性：在Cluster推出之前，可用性要靠（哨兵）Sentinel保证。有了集群之后也自动具有了Sentinel的监控和自动Failover能力。  


redis使用中遇到的瓶颈
---------------------------
我们日常在对于redis的使用中，经常会遇到一些问题
```
1、高可用问题，如何保证redis的持续高可用性。
2、容量问题，单实例redis内存无法无限扩充，达到32G后就进入了64位世界，性能下降。
3、并发性能问题，redis号称单实例10万并发，但也是有尽头的。
```

redis-cluster的优势　　
---------------------------
```
1、官方推荐，毋庸置疑。
2、去中心化，集群最大可增加1000个节点，性能随节点增加而线性扩展。
3、管理方便，后续可自行增加或摘除节点，移动分槽等等。
4、简单，易上手。
```

redis-cluster名词介绍
---------------------------
```
1、master　　主节点  
2、slave　　   从节点
3、slot　　　  槽，一共有16384数据分槽，分布在集群的所有主节点中。
```


redis-cluster在设计的时候，就考虑到了去中心化，去中间件，也就是说，集群中的每个节点都是平等的关系，都是对等的，每个节点都保存各自的数据和整个集群的状态。每个节点都和其他所有节点连接，而且这些连接保持活跃，这样就保证了我们只需要连接集群中的任意一个节点，就可以获取到其他节点的数据。

Redis 集群没有并使用传统的一致性哈希来分配数据，而是采用另外一种叫做哈希槽 (hash slot)的方式来分配的。redis cluster 默认分配了 16384 个slot，当我们set一个key 时，会用CRC16算法与16384取模得到所属的slot，然后将这个key 分到哈希槽区间的节点上，具体算法就是：CRC16(key) % 16384。所以我们在测试的时候看到set 和 get 的时候，直接跳转到了7000端口的节点。

Redis 集群会把数据存在某一个 master 节点，然后在这个 master 和其对应的salve 之间进行数据同步。当读取数据时，也根据一致性哈希算法到对应的 master 节点获取数据。只有当一个master 挂掉之后，才会启动一个对应的 salve 节点，充当 master 。

需要注意的是：必须要3个或以上的主节点，否则在创建集群时会失败，并且当存活的主节点数小于总节点数的一半时，整个集群就无法提供服务了。

redis-cluster的搭建，可以使用 redis-trib.rb命令   

搭建步骤：



